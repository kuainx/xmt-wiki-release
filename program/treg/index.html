



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="XMT WIKI">
      
      
        <link rel="canonical" href="https://docs.runmun.site/program/treg/">
      
      
        <meta name="author" content="KUAI">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../..">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0">
    
    
      
        <title>润梦正式报名表 - XMT-WIKI</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.572ca0f0.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../../assets/javascripts/modernizr.8c900955.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../assets/toomuch.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#_1" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.runmun.site/" title="XMT-WIKI" class="md-header-nav__button md-logo">
          
            <i class="md-icon">cloud</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                XMT-WIKI
              </span>
              <span class="md-header-nav__topic">
                润梦正式报名表
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.runmun.site/" title="XMT-WIKI" class="md-nav__button md-logo">
      
        <i class="md-icon">cloud</i>
      
    </a>
    XMT-WIKI
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="主页" class="md-nav__link">
      主页
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      基本信息
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        基本信息
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../base/baseinfo/" title="基本说明" class="md-nav__link">
      基本说明
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../base/first/" title="说在前面" class="md-nav__link">
      说在前面
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../base/remember/" title="记住" class="md-nav__link">
      记住
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../base/map/" title="地图" class="md-nav__link">
      地图
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../base/activity/" title="活动" class="md-nav__link">
      活动
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      表
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        表
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../table/noun/" title="名词表" class="md-nav__link">
      名词表
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../table/shortcut/" title="常用快捷键" class="md-nav__link">
      常用快捷键
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../table/cmd/" title="运行(Win)" class="md-nav__link">
      运行(Win)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../table/ext/" title="扩展名" class="md-nav__link">
      扩展名
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../table/dir/" title="目录简写" class="md-nav__link">
      目录简写
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      指南
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        指南
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../knowledge/hard/" title="硬件" class="md-nav__link">
      硬件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../knowledge/soft/" title="软件" class="md-nav__link">
      软件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../knowledge/software/" title="微云软件" class="md-nav__link">
      微云软件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../knowledge/meme/" title="梗" class="md-nav__link">
      梗
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../knowledge/wall/" title="翻墙" class="md-nav__link">
      翻墙
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../knowledge/interest/" title="其他一些有趣的事情" class="md-nav__link">
      其他一些有趣的事情
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../knowledge/design/" title="设计相关" class="md-nav__link">
      设计相关
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      信息
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        信息
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../info/info/" title="基本信息" class="md-nav__link">
      基本信息
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../info/device/" title="硬件(设备)信息" class="md-nav__link">
      硬件(设备)信息
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../info/software/" title="软件" class="md-nav__link">
      软件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../info/microsoft/" title="微软（Microsoft）系列" class="md-nav__link">
      微软（Microsoft）系列
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Adobe系列
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Adobe系列
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../adobe/adobe/" title="Adobe概述" class="md-nav__link">
      Adobe概述
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../adobe/ae/" title="AE视频剪辑" class="md-nav__link">
      AE视频剪辑
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../adobe/ps/" title="PS图片处理" class="md-nav__link">
      PS图片处理
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      编程
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        编程
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../web/" title="网页编程概述" class="md-nav__link">
      网页编程概述
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../html/" title="HTML语言" class="md-nav__link">
      HTML语言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../css/" title="CSS语言" class="md-nav__link">
      CSS语言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../js/" title="JS语言" class="md-nav__link">
      JS语言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../php/" title="PHP语言（简单版）" class="md-nav__link">
      PHP语言（简单版）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../json/" title="JSON格式" class="md-nav__link">
      JSON格式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../jquery/" title="JQuery模块" class="md-nav__link">
      JQuery模块
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sql/" title="SQL语言" class="md-nav__link">
      SQL语言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../htaccess/" title="htaccess文件" class="md-nav__link">
      htaccess文件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../regexp/" title="正则表达式" class="md-nav__link">
      正则表达式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../runmun/" title="润梦专题" class="md-nav__link">
      润梦专题
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        润梦正式报名表
      </label>
    
    <a href="./" title="润梦正式报名表" class="md-nav__link md-nav__link--active">
      润梦正式报名表
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#v6" title="正式报名表v6" class="md-nav__link">
    正式报名表v6
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" title="前言" class="md-nav__link">
    前言
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v6_1" title="分析v6" class="md-nav__link">
    分析v6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" title="外链数据" class="md-nav__link">
    外链数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style" title="style" class="md-nav__link">
    style
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#js" title="JS（初始化和文件处理部分）" class="md-nav__link">
    JS（初始化和文件处理部分）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#js_1" title="JS（基础函数声明）" class="md-nav__link">
    JS（基础函数声明）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jsregact" title="JS(RegAct)" class="md-nav__link">
    JS(RegAct)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jscos" title="JS（COS腾讯云）" class="md-nav__link">
    JS（COS腾讯云）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cos" title="腾讯云COS的其他设置内容" class="md-nav__link">
    腾讯云COS的其他设置内容
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#html" title="HTML框架" class="md-nav__link">
    HTML框架
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elseprog/" title="其他库" class="md-nav__link">
      其他库
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../browser/" title="浏览器" class="md-nav__link">
      浏览器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../server/" title="服务器" class="md-nav__link">
      服务器
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      关于
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        关于
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/about/" title="关于" class="md-nav__link">
      关于
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/update/" title="更新日志" class="md-nav__link">
      更新日志
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/grammar/" title="语法和插件" class="md-nav__link">
      语法和插件
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/markdown/" title="Markdown（完整版）" class="md-nav__link">
      Markdown（完整版）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/mkdocs/" title="关于Mkdocs" class="md-nav__link">
      关于Mkdocs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#v6" title="正式报名表v6" class="md-nav__link">
    正式报名表v6
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" title="前言" class="md-nav__link">
    前言
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v6_1" title="分析v6" class="md-nav__link">
    分析v6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" title="外链数据" class="md-nav__link">
    外链数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style" title="style" class="md-nav__link">
    style
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#js" title="JS（初始化和文件处理部分）" class="md-nav__link">
    JS（初始化和文件处理部分）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#js_1" title="JS（基础函数声明）" class="md-nav__link">
    JS（基础函数声明）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jsregact" title="JS(RegAct)" class="md-nav__link">
    JS(RegAct)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jscos" title="JS（COS腾讯云）" class="md-nav__link">
    JS（COS腾讯云）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cos" title="腾讯云COS的其他设置内容" class="md-nav__link">
    腾讯云COS的其他设置内容
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#html" title="HTML框架" class="md-nav__link">
    HTML框架
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#v6" title="正式报名表v6" class="md-nav__link">
    正式报名表v6
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" title="前言" class="md-nav__link">
    前言
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v6_1" title="分析v6" class="md-nav__link">
    分析v6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" title="外链数据" class="md-nav__link">
    外链数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style" title="style" class="md-nav__link">
    style
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#js" title="JS（初始化和文件处理部分）" class="md-nav__link">
    JS（初始化和文件处理部分）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#js_1" title="JS（基础函数声明）" class="md-nav__link">
    JS（基础函数声明）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jsregact" title="JS(RegAct)" class="md-nav__link">
    JS(RegAct)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jscos" title="JS（COS腾讯云）" class="md-nav__link">
    JS（COS腾讯云）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cos" title="腾讯云COS的其他设置内容" class="md-nav__link">
    腾讯云COS的其他设置内容
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#html" title="HTML框架" class="md-nav__link">
    HTML框架
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
              <hr/>
              
                
                
                <h1 id="_1">润梦正式报名表</h1>
<h2 id="v6">正式报名表v6</h2>
<h3 id="_2">前言</h3>
<ul>
<li>为了降低程序（数据库）的复杂程度，v6版本改成了<strong>上传xlsx报名表</strong>文件，想要看报名表填写版本，请见v4（i4.php）</li>
<li>关于v4：v4的复杂性在于上传数据、填写数据，1，上传数据在后端（php）写判断时候容易出错，2，填写数据时候数据<strong>不会保存</strong>（实际上是懒得做，理应填写数据随时保存到localstorage，也不麻烦，不过已经写完了就懒得加了，最后加了快速报名（如果提交时候刷新了可以快速报名）），说是说比较麻烦，不过实际操作也没出什么大问题，不过双代的似乎全部都没有数据，也不知道是所有人都没填还是啥玩意，出过一次问题就是<strong>服务商没有清缓存</strong>，<strong>硬盘空间满了</strong>，然后php就无法执行，数据库也无法访问，但是静态页面不会出问题，但是正式报名就爆炸了，不过问题也不是很大。</li>
<li>关于v6：将手动填写报名表改成了<strong>上传xlsx</strong>，注意：所有xlsx拖放、读取数据都是本地操作，在上传之前都是本地内容，没有上传到服务器（注意：v6的<strong>支付图片也改成了本地显示</strong>！），但是如果数据库爆炸了还是照样爆炸的，解决方法：拿小钱钱换服务器。</li>
<li>v6可以改进的点：<ul>
<li>检查正式报名表填写的学校与选择的学校名称是否相符</li>
<li>检查正式报名表填写的会场是否与规定的一致（xlsx中给选项）</li>
<li>检查正式报名表填写的席位是否与规定的一致（xlsx中给选项，有点困难，但是这个填写符合规范应该是没有问题的，可以给显示一个席位表）</li>
<li>读取学校列表（a步时候）可以直接写成固定json丢COS，减少了获取内容的压力</li>
</ul>
</li>
<li>正式发布前需要注意的内容：<ul>
<li>将大篇幅的js写成单独的js文件丢COS（将php中js删除），减少从服务器获取的压力（如果只有一点点那也无伤大雅，随便了，比如pdf页面），不推荐进行压缩，本来没多大，压缩可能出错（之前有出过错）</li>
<li>将所有非COS的文件都丢到COS中，尤其是bootcdn的文件，之前出过问题，bootcdn不知道搞什么东西，资源失效过，链接替换为了cloudfare</li>
</ul>
</li>
</ul>
<h3 id="v6_1">分析v6</h3>
<h3 id="_3">外链数据</h3>
<ul>
<li>这里还没有单独提出js，纯文本、框架就不解释了</li>
<li><code class="codehilite"><span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;https://runmun-1251935573.cos.ap-chengdu.myqcloud.com/rreg/js/jquery.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></code></li>
<li>Jquery(js)</li>
<li><code class="codehilite"><span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;https://runmun-1251935573.cos.ap-chengdu.myqcloud.com/rreg/js/bootstrap.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></code></li>
<li>bootstrap(js)</li>
<li><code class="codehilite"><span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;https://runmun-1251935573.cos.ap-chengdu.myqcloud.com/rreg/js/popper.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></code></li>
<li>bootstrap的弹窗插件</li>
<li><code class="codehilite"><span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;https://runmun-1251935573.cos.ap-chengdu.myqcloud.com/rreg/js/bootstrap-material-design.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></code></li>
<li>materdesign(js)【<a href="https://github.com/FezVrasta/bootstrap-material-design">https://github.com/FezVrasta/bootstrap-material-design</a>】，有兴趣可以换成【<a href="https://github.com/mdbootstrap/bootstrap-material-design">https://github.com/mdbootstrap/bootstrap-material-design</a>】</li>
<li><code class="codehilite"><span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;https://runmun-1251935573.cos.ap-chengdu.myqcloud.com/rreg/js/framaterial.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></code></li>
<li>framaterial（只有第一个单选框使用了[好像是]）【<a href="https://github.com/Framaterial/framaterial">https://github.com/Framaterial/framaterial</a>】</li>
<li><code class="codehilite"><span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;https://runmun-1251935573.cos.ap-chengdu.myqcloud.com/rreg/js/cos-js-sdk-v5.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></code></li>
<li>腾讯云对象存储（COS）SDK</li>
<li><code class="codehilite"><span class="c">&lt;!--&lt;script src=&quot;./xlsx.new.min.js&quot;&gt;&lt;/script&gt;--&gt;</span>``<span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;https://cdn.bootcss.com/xlsx/0.14.3/xlsx.core.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></code></li>
<li>xlsx模块（由于此处只需要读取，最好用core，比较小）（注：关于xlsx.js见单独的说明）</li>
<li><code class="codehilite"><span class="c">&lt;!--&lt;script src=&quot;https://runmun-1251935573.cos.ap-chengdu.myqcloud.com/rreg/js/rregv2.js?v=1&quot;&gt;&lt;/script&gt;--&gt;</span></code></li>
<li>把js单独来一个代码丢COS</li>
<li><code class="codehilite">&lt;link href=&quot;https://runmun-1251935573.cos.ap-chengdu.myqcloud.com/rreg/css/framaterial.min.css&quot; rel=&quot;stylesheet&quot; /&gt;</code></li>
<li>framaterial的css</li>
<li><code class="codehilite">&lt;link href=&quot;https://runmun-1251935573.cos.ap-chengdu.myqcloud.com/rreg/css/bootstrap-material-design.css&quot; rel=&quot;stylesheet&quot;&gt;</code></li>
<li>bsmd的css</li>
<li><code class="codehilite">&lt;link href=&quot;https://runmun-1251935573.cos.ap-chengdu.myqcloud.com/rreg/css/docs.min.css&quot; rel=&quot;stylesheet&quot;&gt;</code></li>
<li>bsmd的单独css（与源站不同，有修改）</li>
</ul>
<h3 id="style">style</h3>
<div class="codehilite"><pre><span></span><span class="o">*</span><span class="p">{</span><span class="k">user-select</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span><span class="kp">-webkit-</span><span class="k">user-select</span><span class="p">:</span> <span class="kc">none</span><span class="p">;}</span>
<span class="o">//</span><span class="nt">禁止选择</span>
<span class="p">.</span><span class="nc">c-align-center</span><span class="p">{</span><span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;}</span>
<span class="o">//</span><span class="nt">居中</span>
<span class="p">.</span><span class="nc">container</span><span class="p">{</span><span class="k">transition</span><span class="p">:</span> <span class="kc">all</span> <span class="mf">0.5</span><span class="kt">s</span> <span class="kc">ease</span> <span class="mi">0</span><span class="kt">s</span> <span class="cp">!important</span><span class="p">;</span><span class="k">padding</span><span class="p">:</span> <span class="mi">2</span><span class="kt">%</span><span class="p">;}</span>
<span class="o">//</span><span class="nt">卡片变换渐变设置</span><span class="o">(</span><span class="nt">transition</span><span class="o">)</span>
<span class="nt">ul</span><span class="p">{</span><span class="n">pointer-events</span><span class="p">:</span> <span class="kc">none</span><span class="p">;}</span>
<span class="o">//</span><span class="nt">列表禁止单击</span><span class="err">（</span><span class="nt">a卡片协议显示需要</span><span class="err">，</span><span class="nt">关闭单击特效</span><span class="err">）</span>
<span class="p">.</span><span class="nc">bottom-a</span><span class="p">{</span><span class="k">bottom</span><span class="p">:</span><span class="mi">0</span><span class="p">;}</span>
<span class="o">//</span><span class="nt">卡片高度大于窗口高度时底边不空白</span>
<span class="nt">th</span> <span class="o">,</span> <span class="nt">td</span><span class="p">{</span><span class="k">vertical-align</span><span class="p">:</span> <span class="kc">middle</span> <span class="cp">!important</span><span class="p">;}</span>
<span class="o">//</span><span class="nt">表格内容上下居中</span>
<span class="nt">input</span><span class="o">,</span> <span class="nt">textarea</span> <span class="p">{</span><span class="kp">-khtml-</span><span class="k">user-select</span><span class="p">:</span> <span class="kc">text</span><span class="cp">!important</span><span class="p">;</span><span class="kp">-moz-</span><span class="k">user-select</span><span class="p">:</span> <span class="kc">text</span><span class="cp">!important</span><span class="p">;</span><span class="kp">-ms-</span><span class="k">user-select</span><span class="p">:</span> <span class="kc">text</span><span class="cp">!important</span><span class="p">;</span><span class="kp">-o-</span><span class="k">user-select</span><span class="p">:</span> <span class="kc">text</span><span class="cp">!important</span><span class="p">;</span><span class="k">user-select</span><span class="p">:</span> <span class="kc">text</span><span class="cp">!important</span><span class="p">;</span><span class="kp">-webkit-</span><span class="k">user-select</span><span class="p">:</span> <span class="kc">text</span><span class="cp">!important</span><span class="p">;}</span>
<span class="o">//</span><span class="nt">输入框</span><span class="o">(</span><span class="nt">input</span><span class="o">)</span><span class="nt">和大型输入框</span><span class="o">(</span><span class="nt">textarea</span><span class="o">)</span><span class="nt">可选择</span><span class="err">，</span><span class="nt">修复safari的问题</span>
<span class="p">#</span><span class="nn">drop</span><span class="o">,</span> <span class="p">#</span><span class="nn">drop-pic</span><span class="p">{</span><span class="k">border</span><span class="p">:</span><span class="mi">2</span><span class="kt">px</span> <span class="kc">dashed</span> <span class="mh">#bbb</span><span class="p">;</span><span class="kp">-moz-</span><span class="k">border-radius</span><span class="p">:</span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span><span class="kp">-webkit-</span><span class="k">border-radius</span><span class="p">:</span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span><span class="k">border-radius</span><span class="p">:</span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span><span class="k">padding</span><span class="p">:</span><span class="mi">25</span><span class="kt">px</span><span class="p">;</span><span class="k">text-align</span><span class="p">:</span><span class="kc">center</span><span class="p">;</span><span class="k">font</span><span class="p">:</span><span class="mi">20</span><span class="kt">pt</span> <span class="kc">bold</span><span class="p">,</span><span class="s2">&quot;Vollkorn&quot;</span><span class="p">;</span><span class="k">color</span><span class="p">:</span><span class="mh">#bbb</span><span class="p">}</span>
<span class="o">//</span><span class="nt">拖拽框的css</span>
</pre></div>

<h3 id="js">JS（初始化和文件处理部分）</h3>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">load_btn</span><span class="p">,</span><span class="nx">bg</span><span class="p">,</span><span class="nx">AModalText</span><span class="p">,</span><span class="nx">reg</span><span class="p">,</span><span class="nx">SchoolList</span><span class="p">,</span><span class="nx">RegList</span><span class="p">,</span><span class="nx">now</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">;</span>
<span class="c1">//变量说明：加载圈，背景(窗口)，弹出模态框，卡片列表，学校列表，学校信息，当前卡片</span>
<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
<span class="c1">//资源加载完成调用函数</span>
    <span class="nx">load_btn</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;load_btn&quot;</span><span class="p">);</span>
    <span class="c1">//加载圈</span>
    <span class="nx">bg</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;bg&quot;</span><span class="p">);</span>
    <span class="c1">//背景（窗口），宽高都为100%，用于读取窗口宽高，以下直接称窗口宽高</span>
    <span class="nx">AModalText</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;AlertModal-text&quot;</span><span class="p">);</span>
    <span class="c1">//弹出提示框（模态框）</span>
    <span class="nx">reg</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">a</span><span class="o">:</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;reg-a&quot;</span><span class="p">),</span>
        <span class="nx">b</span><span class="o">:</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;reg-b&quot;</span><span class="p">),</span>
        <span class="nx">c</span><span class="o">:</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;reg-c&quot;</span><span class="p">),</span>
        <span class="nx">d</span><span class="o">:</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;reg-d&quot;</span><span class="p">),</span>
        <span class="nx">e</span><span class="o">:</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;reg-e&quot;</span><span class="p">),</span>
        <span class="nx">f</span><span class="o">:</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;reg-f&quot;</span><span class="p">),</span>
        <span class="nx">g</span><span class="o">:</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;reg-g&quot;</span><span class="p">)</span>
    <span class="p">};</span>
    <span class="c1">//卡片列表</span>
    <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="c1">//时钟事件，15ms一次，66.67fps，目标为60fps</span>
        <span class="nx">reg</span><span class="p">[</span><span class="nx">now</span><span class="p">].</span><span class="nx">offsetHeight</span> <span class="o">&lt;=</span> <span class="nx">bg</span><span class="p">.</span><span class="nx">offsetHeight</span> <span class="o">?</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#reg-&quot;</span><span class="o">+</span><span class="nx">now</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;bottom-a&quot;</span><span class="p">))</span> <span class="o">:</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#reg-&quot;</span><span class="o">+</span><span class="nx">now</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;bottom-a&quot;</span><span class="p">));</span>
        <span class="c1">//判断当前卡片的高度是否小于等于窗口,若小于，则bottom:0（底边和父元素空间0），大于则保持默认，上下居中</span>
    <span class="p">},</span><span class="mi">15</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">bootstrapMaterialDesign</span><span class="p">();</span>
    <span class="c1">//body元素进行materialDedign初始化</span>
    <span class="c1">//文件处理（以下调用xlsxDEMO，有修改）</span>
    <span class="kd">var</span> <span class="nx">X</span> <span class="o">=</span> <span class="nx">XLSX</span><span class="p">;</span>
    <span class="c1">//XLSX全局变量</span>
    <span class="kd">var</span> <span class="nx">to_json</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">workbook</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//转JSOn函数</span>
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="nx">workbook</span><span class="p">.</span><span class="nx">SheetNames</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">sheetName</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">roa</span> <span class="o">=</span> <span class="nx">X</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">sheet_to_json</span><span class="p">(</span><span class="nx">workbook</span><span class="p">.</span><span class="nx">Sheets</span><span class="p">[</span><span class="nx">sheetName</span><span class="p">],</span> <span class="p">{</span><span class="nx">header</span><span class="o">:</span><span class="mi">1</span><span class="p">});</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">roa</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="nx">result</span><span class="p">[</span><span class="nx">sheetName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">roa</span><span class="p">;</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">process_wb</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">wb</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//处理函数</span>
        <span class="nx">output</span> <span class="o">=</span> <span class="nx">to_json</span><span class="p">(</span><span class="nx">wb</span><span class="p">);</span>
        <span class="c1">//将结果转json</span>
        <span class="nx">output</span> <span class="o">=</span> <span class="nx">output</span><span class="p">[</span><span class="s2">&quot;正式报名表&quot;</span><span class="p">];</span>
        <span class="c1">//取出json中的“正式报名表”数据表</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">output</span><span class="o">===</span><span class="kc">undefined</span><span class="p">){</span>
        <span class="c1">//如果未找到表，弹窗提示</span>
            <span class="nx">AlertM</span><span class="p">(</span><span class="s2">&quot;文件名：&quot;</span><span class="o">+</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s2">&quot;&lt;br/&gt;文件类型：&quot;</span><span class="o">+</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">type</span><span class="o">+</span><span class="s2">&quot;&lt;br/&gt;该报名表数据无法读取，请检查文件后重新选择&lt;br/&gt;若确认文件无误，仍可点击确认上传&quot;</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">output</span><span class="p">);</span><span class="c1">//输出数据</span>
            <span class="nx">regAct</span><span class="p">.</span><span class="nx">outInfo</span><span class="p">(</span><span class="nx">output</span><span class="p">);</span>
            <span class="c1">//调用outInfo函数将数据处理成HTML表格</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">do_file</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">files</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//处理XLSX文件</span>
        <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="nx">files</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="c1">//取出文件列表第一个文件</span>
        <span class="nx">retArr</span><span class="p">.</span><span class="nx">file</span><span class="o">=</span><span class="nx">f</span><span class="p">;</span>
        <span class="c1">//将文件保存到retArr（结果返回值）中</span>
        <span class="kd">var</span> <span class="nx">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileReader</span><span class="p">();</span>
        <span class="c1">//初始化FileReader（H5的API）</span>
        <span class="nx">reader</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//reader读取完毕</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;onload_xlsx&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
            <span class="c1">//输出开始处理时间</span>
            <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
            <span class="c1">//取结果</span>
            <span class="nx">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Uint8Array</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
            <span class="c1">//结果转二进制</span>
            <span class="nx">process_wb</span><span class="p">(</span><span class="nx">X</span><span class="p">.</span><span class="nx">read</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;array&#39;</span><span class="p">}));</span>
            <span class="c1">//XLSX处理</span>
        <span class="p">};</span>
        <span class="nx">reader</span><span class="p">.</span><span class="nx">readAsArrayBuffer</span><span class="p">(</span><span class="nx">f</span><span class="p">);</span>
        <span class="c1">//开始读取文件</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">do_pic</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">files</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//处理图片文件，一样的就不解释了</span>
        <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="nx">files</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="nx">retArr</span><span class="p">.</span><span class="nx">pic</span><span class="o">=</span><span class="nx">f</span><span class="p">;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;pay-img&quot;</span><span class="p">).</span><span class="nx">src</span><span class="o">=</span><span class="nx">URL</span><span class="p">.</span><span class="nx">createObjectURL</span><span class="p">(</span><span class="nx">f</span><span class="p">);</span>
        <span class="c1">//直接将文件创建bloburl，赋给src，与直接图片链接效果相同（createObjectURL填入Blob对象，file是blob的特殊类型）</span>
        <span class="nx">AlertM</span><span class="p">(</span><span class="s2">&quot;文件名：&quot;</span><span class="o">+</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">pic</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s2">&quot;&lt;br/&gt;文件类型：&quot;</span><span class="o">+</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">pic</span><span class="p">.</span><span class="nx">type</span><span class="o">+</span><span class="s2">&quot;&lt;br/&gt;文件大小：&quot;</span><span class="o">+</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">pic</span><span class="p">.</span><span class="nx">size</span><span class="o">/</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="o">+</span><span class="s2">&quot;KB&lt;br/&gt;请确认左图为正确文件后点击确认上传&quot;</span><span class="p">);</span>
        <span class="c1">//弹出提示框</span>
    <span class="p">};</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;xlsx_file&quot;</span><span class="p">).</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="nx">do_file</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span><span class="p">);},</span> <span class="kc">false</span><span class="p">);</span>
    <span class="c1">//对xlsx_file文件选择框添加change（文件改变）事件监听器，改变后调用处理函数</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;pic_file&quot;</span><span class="p">).</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="nx">do_pic</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span><span class="p">);},</span> <span class="kc">false</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">drop</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;drop&#39;</span><span class="p">);</span>
    <span class="c1">//获取drop（拖拽框）对象</span>
    <span class="kd">var</span> <span class="nx">drop_pic</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;drop-pic&#39;</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">drop</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
    <span class="c1">//如果不存在drop对象或不支持addEventListener，则终止函数</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">drop_pic</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
    <span class="kd">function</span> <span class="nx">handleDrop</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//处理拖放事件(文件在对象上释放)</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
        <span class="c1">//阻止冒泡事件（消息传递至上层建筑）</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
        <span class="c1">//阻止默认事件</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">files</span><span class="p">);</span>
        <span class="c1">//输出文件列表</span>
        <span class="nx">do_file</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">files</span><span class="p">);</span>
        <span class="c1">//处理文件</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">handleDrop_pic</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">files</span><span class="p">);</span>
        <span class="nx">do_pic</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">files</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">handleDragover</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//处理拖放事件（文件在对象上移动）</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">dropEffect</span> <span class="o">=</span> <span class="s1">&#39;copy&#39;</span><span class="p">;</span>
        <span class="c1">//设置拖放操作为复制</span>
    <span class="p">}</span>
    <span class="nx">drop</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;dragenter&#39;</span><span class="p">,</span> <span class="nx">handleDragover</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="c1">//绑定拖放进入对象的事件</span>
    <span class="nx">drop</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;dragover&#39;</span><span class="p">,</span> <span class="nx">handleDragover</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="c1">//绑定拖放事件（在对象上方）</span>
    <span class="nx">drop_pic</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;dragenter&#39;</span><span class="p">,</span> <span class="nx">handleDragover</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="nx">drop_pic</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;dragover&#39;</span><span class="p">,</span> <span class="nx">handleDragover</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="nx">drop</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;drop&#39;</span><span class="p">,</span> <span class="nx">handleDrop</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="c1">//绑定拖放事件（释放）</span>
    <span class="nx">drop_pic</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;drop&#39;</span><span class="p">,</span> <span class="nx">handleDrop_pic</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="c1">//文件处理结束</span>
<span class="p">});</span>
</pre></div>

<h3 id="js_1">JS（基础函数声明）</h3>
<div class="codehilite"><pre><span></span><span class="nb">window</span><span class="p">.</span><span class="nx">onload</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span>
<span class="c1">//页面加载完成调用函数</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;load_btn&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">;</span>
    <span class="c1">//加载完成后取消显示加载圈</span>
<span class="p">};</span>
<span class="kd">var</span> <span class="nx">downloadXlsx</span> <span class="o">=</span> <span class="p">()=&gt;{</span>
<span class="c1">//下载函数（来源pdf页面）</span>
    <span class="nx">AlertM</span><span class="p">(</span><span class="s1">&#39;&lt;div class=&quot;progress&quot; style=&quot;height: 20px;&quot;&gt;&lt;div class=&quot;progress-bar progress-bar-striped progress-bar-animated bg-info&quot; role=&quot;progressbar&quot; id=&quot;prog&quot; style=&quot;width: 20%&quot; aria-valuenow=&quot;50&quot; aria-valuemin=&quot;0&quot; aria-valuemax=&quot;100&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
    <span class="c1">//弹出提示框</span>
    <span class="kd">var</span> <span class="nx">prog</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;prog&quot;</span><span class="p">);</span>
    <span class="c1">//获取刚才弹出的提示框中进度条对象</span>
    <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;https://runmun-1251935573.cos.ap-chengdu.myqcloud.com/%E6%B6%A6%E6%A2%A62019%E6%AD%A3%E5%BC%8F%E6%8A%A5%E5%90%8D%E8%A1%A8(%E7%A9%BA%E7%99%BD).xlsx&#39;</span><span class="p">;</span>
    <span class="c1">//xlsxURL</span>
    <span class="kd">var</span> <span class="nx">urlArr</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">);</span>
    <span class="nx">s</span> <span class="o">=</span> <span class="nx">urlArr</span><span class="p">[</span><span class="nx">urlArr</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
    <span class="nx">urlArr</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">);</span>
    <span class="nx">file</span> <span class="o">=</span> <span class="nb">decodeURI</span><span class="p">(</span><span class="nx">urlArr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="c1">//以上获取url中文件名</span>
    <span class="nx">s</span><span class="o">=</span><span class="nx">url</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
    <span class="c1">//初始化xhr下载对象</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="c1">//get方式获取文件</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">responseType</span> <span class="o">=</span> <span class="s2">&quot;blob&quot;</span><span class="p">;</span>
    <span class="c1">//获取blob二进制对象（文件）</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//200下载成功</span>
          <span class="kd">var</span> <span class="nx">blob</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">response</span><span class="p">;</span>
          <span class="c1">//读取获取到的二进制对象</span>
          <span class="nx">s</span><span class="o">=</span><span class="nx">URL</span><span class="p">.</span><span class="nx">createObjectURL</span><span class="p">(</span><span class="nx">blob</span><span class="p">);</span>
          <span class="c1">//将二进制对象创建blobURL</span>
          <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
          <span class="c1">//延时调用函数，1s后显示下载成功</span>
              <span class="nx">AlertM</span><span class="p">(</span><span class="s1">&#39;&lt;div style=&quot;text-align:center;&quot;&gt;&lt;a class=&quot;btn btn-info&quot; style=&quot;margin:5px;&quot; href=&quot;&#39;</span><span class="o">+</span><span class="nx">s</span><span class="o">+</span><span class="s1">&#39;&quot; download=&quot;&#39;</span><span class="o">+</span><span class="nx">file</span><span class="o">+</span><span class="s1">&#39;&quot;&gt;点击下载&lt;/a&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
          <span class="p">},</span><span class="mi">1000</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="c1">//其他下载失败</span>
            <span class="nx">AlertM</span><span class="p">(</span><span class="s2">&quot;文件传输出错，请重试&lt;br/&gt;错误代码：&quot;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">status</span><span class="o">+</span><span class="s1">&#39;  &#39;</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">statusText</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">onprogress</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="c1">//下载进度调用函数</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
      <span class="nx">prog</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">loaded</span> <span class="o">/</span> <span class="nx">e</span><span class="p">.</span><span class="nx">total</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">+</span> <span class="s2">&quot;%&quot;</span><span class="p">;</span>
      <span class="c1">//进度条进度</span>
      <span class="nx">prog</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">loaded</span> <span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span> <span class="nx">e</span><span class="p">.</span><span class="nx">total</span><span class="o">+</span><span class="s1">&#39;&amp;emsp;&amp;emsp;&#39;</span><span class="o">+</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">loaded</span> <span class="o">/</span> <span class="nx">e</span><span class="p">.</span><span class="nx">total</span> <span class="o">*</span> <span class="mi">10000</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span> <span class="o">+</span> <span class="s2">&quot;%&quot;</span><span class="p">;;</span>
      <span class="c1">//进度条文字</span>
    <span class="p">}</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
    <span class="c1">//开始下载</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">AlertM</span> <span class="o">=</span> <span class="p">(</span><span class="nx">text</span><span class="p">)=&gt;{</span>
<span class="c1">//提示框调用函数</span>
    <span class="nx">AModalText</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">text</span><span class="p">;</span>
    <span class="c1">//提示框内容</span>
    <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#AlertModal&quot;</span><span class="p">).</span><span class="nx">modal</span><span class="p">(</span><span class="s2">&quot;show&quot;</span><span class="p">);</span>
    <span class="c1">//显示模态框</span>
<span class="p">};</span>
<span class="kd">var</span> <span class="nx">check</span> <span class="o">=</span> <span class="p">{</span>
<span class="c1">//检查函数列表</span>
    <span class="nx">empty</span><span class="o">:</span><span class="p">(</span><span class="nx">e</span><span class="p">)=&gt;{</span>
    <span class="c1">//检查是否为空，null,empty,false则返回true，不为空返回false</span>
        <span class="k">return</span> <span class="nx">e</span><span class="o">?</span><span class="kc">false</span><span class="o">:</span><span class="kc">true</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">notPhone</span><span class="o">:</span><span class="p">(</span><span class="nx">e</span><span class="p">)=&gt;{</span>
    <span class="c1">//不是手机则标红</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">check</span><span class="p">.</span><span class="nx">empty</span><span class="p">(</span><span class="nx">e</span><span class="p">)){</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;b style=&quot;color:red&quot;&gt;空&lt;/b&gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="sr">/^[1-9]\d{10,10}$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">e</span><span class="p">)){</span>
        <span class="c1">//正则表达式判断：首位1-9数字+10位数字</span>
            <span class="k">return</span> <span class="nx">e</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;b style=&quot;color:red&quot;&gt;&#39;</span><span class="o">+</span><span class="nx">e</span><span class="o">+</span><span class="s1">&#39;&lt;/b&gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">notQQ</span><span class="o">:</span><span class="p">(</span><span class="nx">e</span><span class="p">)=&gt;{</span>
    <span class="c1">//不是QQ则标红</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">check</span><span class="p">.</span><span class="nx">empty</span><span class="p">(</span><span class="nx">e</span><span class="p">)){</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;b style=&quot;color:red&quot;&gt;空&lt;/b&gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="sr">/^[1-9]\d{4,10}$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">e</span><span class="p">)){</span>
        <span class="c1">//首位1-9数字+4-10位数字</span>
            <span class="k">return</span> <span class="nx">e</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;b style=&quot;color:red&quot;&gt;&#39;</span><span class="o">+</span><span class="nx">e</span><span class="o">+</span><span class="s1">&#39;&lt;/b&gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">isIdentity</span><span class="o">:</span><span class="p">(</span><span class="nx">e</span><span class="p">)=&gt;{</span>
    <span class="c1">//是身份证返回true，否则返回false</span>
        <span class="c1">//18位身份证，X大写</span>
        <span class="kd">let</span> <span class="nx">regIdCard</span><span class="o">=</span><span class="sr">/^[1-9]\d{5}[1-2]\d{3}((0[1-9])|(1[0-2]))(0[1-9]|([1|2]\d)|3[0-1])((\d{4})|\d{3}X)$/</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">regIdCard</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">e</span><span class="p">)){</span>
            <span class="kd">let</span> <span class="nx">idCardWi</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
            <span class="kd">let</span> <span class="nx">idCardY</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
            <span class="kd">let</span> <span class="nx">idCardWiSum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">17</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span><span class="nx">idCardWiSum</span> <span class="o">+=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nx">idCardWi</span><span class="p">[</span><span class="nx">i</span><span class="p">];}</span>
            <span class="kd">let</span> <span class="nx">idCardMod</span> <span class="o">=</span> <span class="nx">idCardWiSum</span> <span class="o">%</span> <span class="mi">11</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">==</span> <span class="nx">idCardY</span><span class="p">[</span><span class="nx">idCardMod</span><span class="p">])</span> <span class="p">{</span><span class="k">return</span> <span class="kc">true</span><span class="p">;}</span> <span class="k">else</span> <span class="p">{</span><span class="k">return</span> <span class="kc">false</span><span class="p">;}</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="k">return</span> <span class="kc">false</span><span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">notIdentity</span><span class="o">:</span><span class="p">(</span><span class="nx">e</span><span class="p">)=&gt;{</span>
    <span class="c1">//不是身份证则标红</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">check</span><span class="p">.</span><span class="nx">empty</span><span class="p">(</span><span class="nx">e</span><span class="p">)){</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;b style=&quot;color:red&quot;&gt;空&lt;/b&gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">check</span><span class="p">.</span><span class="nx">isIdentity</span><span class="p">(</span><span class="nx">e</span><span class="p">)){</span>
            <span class="k">return</span> <span class="nx">e</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="k">return</span> <span class="s1">&#39;&lt;b style=&quot;color:red&quot;&gt;&#39;</span><span class="o">+</span><span class="nx">e</span><span class="o">+</span><span class="s1">&#39;&lt;/b&gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">notEmpty</span><span class="o">:</span><span class="p">(</span><span class="nx">a</span><span class="p">)=&gt;{</span>
        <span class="k">return</span> <span class="nx">a</span><span class="o">?</span><span class="nx">a</span><span class="o">:</span><span class="s1">&#39;&lt;b style=&quot;color:red&quot;&gt;空&lt;/b&gt;&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="c1">//初始化加载圈函数</span>
<span class="kd">var</span> <span class="nx">load</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">show</span><span class="o">:</span> <span class="p">()=&gt;{</span>
    <span class="c1">//显示加载圈</span>
        <span class="kd">let</span> <span class="nx">height</span> <span class="o">=</span> <span class="nx">bg</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">width</span> <span class="o">=</span> <span class="nx">bg</span><span class="p">.</span><span class="nx">offsetWidth</span><span class="p">;</span>
        <span class="c1">//获取窗口宽高</span>
        <span class="nx">load_btn</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">heigh</span><span class="o">=</span><span class="nx">height</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">;</span>
        <span class="nx">load_btn</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="o">=</span><span class="nx">width</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">;</span>
        <span class="c1">//加载圈宽高等于窗口宽高（加载圈背景半透明+圈在正中间）</span>
        <span class="nx">load_btn</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;block&quot;</span><span class="p">;</span>
        <span class="c1">//显示加载圈</span>
    <span class="p">},</span>
    <span class="c1">//</span>
    <span class="nx">none</span><span class="o">:</span> <span class="p">()=&gt;{</span>
    <span class="c1">//隐藏加载圈</span>
        <span class="nx">load_btn</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">up</span><span class="o">:</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">n</span><span class="p">)=&gt;{</span>
    <span class="c1">//前进卡片（css中设置了渐变，直接改即可）</span>
        <span class="nx">reg</span><span class="p">[</span><span class="nx">e</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="c1">//当前卡片的透明度为0</span>
        <span class="nx">reg</span><span class="p">[</span><span class="nx">e</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="mi">0</span><span class="o">-</span><span class="nx">reg</span><span class="p">[</span><span class="nx">e</span><span class="p">].</span><span class="nx">offsetWidth</span><span class="o">+</span><span class="s2">&quot;px&quot;</span><span class="p">;</span>
        <span class="c1">//left渐变为负的宽度（卡片右端移动到窗口最左侧）</span>
        <span class="nx">reg</span><span class="p">[</span><span class="nx">e</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">right</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">;</span>
        <span class="c1">//右侧自动</span>
        <span class="nx">now</span><span class="o">=</span><span class="nx">n</span><span class="p">;</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">reg</span><span class="p">[</span><span class="nx">e</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">;</span><span class="nx">reg</span><span class="p">[</span><span class="nx">n</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nx">reg</span><span class="p">[</span><span class="nx">n</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">;</span><span class="nx">load</span><span class="p">.</span><span class="nx">none</span><span class="p">();},</span><span class="mi">500</span><span class="p">);</span>
        <span class="c1">//500ms后当前卡片隐藏，下一张卡片透明度1（100%），隐藏加载圈</span>
    <span class="p">},</span>
    <span class="nx">back</span><span class="o">:</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">n</span><span class="p">)=&gt;{</span>
    <span class="c1">//后退卡片</span>
        <span class="nx">reg</span><span class="p">[</span><span class="nx">e</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="c1">//当前卡片透明度为0</span>
        <span class="nx">now</span><span class="o">=</span><span class="nx">n</span><span class="p">;</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">reg</span><span class="p">[</span><span class="nx">e</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">;</span><span class="nx">reg</span><span class="p">[</span><span class="nx">n</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nx">reg</span><span class="p">[</span><span class="nx">n</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">;</span><span class="nx">reg</span><span class="p">[</span><span class="nx">n</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">reg</span><span class="p">[</span><span class="nx">n</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">right</span><span class="o">=</span><span class="mi">0</span><span class="p">;},</span><span class="mi">500</span><span class="p">);</span>
        <span class="c1">//500ms后当前卡片隐藏，前一张卡片透明度为1（渐变），前一张卡片左0又0（相当于居中）</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

<h3 id="jsregact">JS(RegAct)</h3>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">regAct</span> <span class="o">=</span> <span class="p">{</span>
<span class="c1">//a,b,c等函数都是在该卡片点击下一步调用的函数，调用内容见HTML框架</span>
    <span class="nx">a</span><span class="o">:</span> <span class="p">()=&gt;{</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;ck_1&quot;</span><span class="p">).</span><span class="nx">checked</span><span class="p">){</span>
        <span class="c1">//ck_1是第一页选择框旋然后的id，直接搜搜不到，渲染后可见</span>
            <span class="nx">load</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;/get/school&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">){</span>
            <span class="c1">//获取学校列表（可做成JSON）</span>
                <span class="nx">SchoolList</span><span class="o">=</span><span class="nx">result</span><span class="p">.</span><span class="nx">ret</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">content</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">ret</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
                <span class="c1">//遍历列表</span>
                    <span class="nx">content</span><span class="o">+=</span><span class="s1">&#39;&lt;span class=&quot;bmd-form-group is-filled&quot;&gt;&lt;div class=&quot;radio&quot;&gt;&lt;label&gt;&lt;input type=&quot;radio&quot; name=&quot;reg-b-school-check&quot; id=&quot;reg-b-school-check&quot; value=&quot;&#39;</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">school</span><span class="o">+</span><span class="s1">&#39;&quot;&gt;&lt;span class=&quot;bmd-radio&quot;&gt;&lt;/span&gt;&#39;</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">school</span><span class="o">+</span><span class="s1">&#39;&lt;/label&gt;&lt;/div&gt;&lt;/span&gt;&#39;</span><span class="p">;</span>
                    <span class="c1">//将学校名称渲染为列表</span>
                <span class="p">});</span>
                <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;SchoolList&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">content</span><span class="p">;</span>
                <span class="nx">load</span><span class="p">.</span><span class="nx">up</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="nx">AlertM</span><span class="p">(</span><span class="s2">&quot;请确认须知&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">searchSchool</span><span class="o">:</span> <span class="p">()=&gt;{</span>
    <span class="c1">//搜索学校</span>
        <span class="kd">var</span> <span class="nx">key</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;SchoolName&quot;</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
        <span class="c1">//读取搜索内容（key）</span>
        <span class="kd">var</span> <span class="nx">content</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="nx">SchoolList</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
        <span class="c1">//遍历学校列表</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">school</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">content</span><span class="o">+=</span><span class="s1">&#39;&lt;span class=&quot;bmd-form-group is-filled&quot;&gt;&lt;div class=&quot;radio&quot;&gt;&lt;label&gt;&lt;input type=&quot;radio&quot; name=&quot;reg-b-school-check&quot; value=&quot;&#39;</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">school</span><span class="o">+</span><span class="s1">&#39;&quot;&gt;&lt;span class=&quot;bmd-radio&quot;&gt;&lt;/span&gt;&#39;</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">school</span><span class="o">+</span><span class="s1">&#39;&lt;/label&gt;&lt;/div&gt;&lt;/span&gt;&#39;</span><span class="p">);</span>
            <span class="c1">//在学校名中搜索key，如果搜索到（！=-1），则渲染该学校名称</span>
        <span class="p">});</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;SchoolList&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">content</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">b</span><span class="o">:</span> <span class="p">()=&gt;{</span>
        <span class="kd">let</span> <span class="nx">schoolChecked</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;input[name=&#39;reg-b-school-check&#39;]:checked&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
        <span class="c1">//获取列表中选择的学校名</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">schoolChecked</span><span class="o">!==</span><span class="kc">undefined</span><span class="p">){</span>
        <span class="c1">//判断是否选中</span>
            <span class="nx">load</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/get/schoolInfo&#39;</span><span class="p">,{</span><span class="s1">&#39;s&#39;</span><span class="o">:</span><span class="nx">schoolChecked</span><span class="p">},</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">){</span>
            <span class="c1">//拉取学校信息</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">status</span><span class="o">==</span><span class="mi">400</span><span class="p">){</span>
                <span class="c1">//status==400则成功</span>
                    <span class="nx">RegList</span><span class="o">=</span><span class="nx">result</span><span class="p">.</span><span class="nx">ret</span><span class="p">;</span>
                    <span class="nx">retArr</span><span class="p">.</span><span class="nx">school</span><span class="o">=</span><span class="nx">schoolChecked</span><span class="p">;</span>
                    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;c-SchoolName&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">schoolChecked</span><span class="p">;</span>
                    <span class="c1">//将取到的内容填入c卡片</span>
                    <span class="k">if</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">ret</span><span class="p">.</span><span class="nx">info</span><span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">){</span>
                    <span class="c1">//如果信息不为空（undefined），填入</span>
                        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;c-SchoolInfo&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">result</span><span class="p">.</span><span class="nx">ret</span><span class="p">.</span><span class="nx">info</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="nx">load</span><span class="p">.</span><span class="nx">up</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">);</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="nx">AlertM</span><span class="p">(</span><span class="s2">&quot;错误：&quot;</span><span class="o">+</span><span class="nx">result</span><span class="p">.</span><span class="nx">status</span><span class="o">+</span><span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="o">+</span><span class="nx">result</span><span class="p">.</span><span class="nx">ret</span><span class="p">);</span>
                    <span class="nx">load</span><span class="p">.</span><span class="nx">none</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="nx">AlertM</span><span class="p">(</span><span class="s2">&quot;请于单选框选择学校&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">c</span><span class="o">:</span> <span class="p">()=&gt;{</span>
        <span class="nx">load</span><span class="p">.</span><span class="nx">up</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">outInfo</span><span class="o">:</span> <span class="p">(</span><span class="nx">json</span><span class="p">)=&gt;{</span>
    <span class="c1">//处理xlsxJSON为HTML表格</span>
        <span class="kd">var</span> <span class="nx">school</span><span class="p">,</span><span class="nx">leader_name</span><span class="p">,</span><span class="nx">leader_phone</span><span class="p">,</span><span class="nx">num</span><span class="p">,</span><span class="nx">empty</span><span class="o">=</span><span class="s1">&#39;&lt;b style=&quot;color:red&quot;&gt;空&lt;/b&gt;&#39;</span><span class="p">;</span>
        <span class="c1">//按照单元格位置读取数据</span>
        <span class="nx">school</span> <span class="o">=</span> <span class="nx">check</span><span class="p">.</span><span class="nx">notEmpty</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span>
        <span class="nx">leader_name</span> <span class="o">=</span> <span class="nx">check</span><span class="p">.</span><span class="nx">notEmpty</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]);</span>
        <span class="nx">leader_phone</span> <span class="o">=</span> <span class="nx">check</span><span class="p">.</span><span class="nx">notPhone</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">5</span><span class="p">]);</span>
        <span class="kd">var</span> <span class="nx">Arr</span><span class="o">=</span><span class="p">[],</span><span class="nx">next</span><span class="o">=</span><span class="kc">true</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">leader_pay</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">next</span><span class="p">){</span>
        <span class="c1">//读取“姓名”列的数据作为人数参考</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">===</span><span class="kc">undefined</span><span class="p">){</span>
            <span class="c1">//如果姓名为空，终止遍历</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">Arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="p">{</span>
                <span class="nx">name</span><span class="o">:</span><span class="nx">check</span><span class="p">.</span><span class="nx">notEmpty</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
                <span class="nx">sex</span><span class="o">:</span><span class="nx">check</span><span class="p">.</span><span class="nx">notEmpty</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span>
                <span class="nx">room</span><span class="o">:</span><span class="nx">check</span><span class="p">.</span><span class="nx">notEmpty</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">4</span><span class="p">][</span><span class="mi">3</span><span class="p">]),</span>
                <span class="nx">seat</span><span class="o">:</span><span class="nx">check</span><span class="p">.</span><span class="nx">notEmpty</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]),</span>
                <span class="kr">double</span><span class="o">:</span><span class="nx">check</span><span class="p">.</span><span class="nx">notEmpty</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">4</span><span class="p">][</span><span class="mi">5</span><span class="p">]),</span>
                <span class="nx">phone</span><span class="o">:</span><span class="nx">check</span><span class="p">.</span><span class="nx">notPhone</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">4</span><span class="p">][</span><span class="mi">6</span><span class="p">]),</span>
                <span class="nx">identity</span><span class="o">:</span><span class="nx">check</span><span class="p">.</span><span class="nx">notIdentity</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">4</span><span class="p">][</span><span class="mi">7</span><span class="p">].</span><span class="nx">toUpperCase</span><span class="p">()),</span>
                <span class="nx">fri</span><span class="o">:</span><span class="nx">check</span><span class="p">.</span><span class="nx">notEmpty</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">4</span><span class="p">][</span><span class="mi">8</span><span class="p">]),</span>
                <span class="nx">sat</span><span class="o">:</span><span class="nx">check</span><span class="p">.</span><span class="nx">notEmpty</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">4</span><span class="p">][</span><span class="mi">9</span><span class="p">])</span>
            <span class="p">}</span>
            <span class="c1">//将数据处理为arr数组，顺便判断是否为空，是否符合要求</span>
            <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">check</span><span class="p">.</span><span class="nx">empty</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">7</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">json</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span><span class="o">!==</span><span class="nx">i</span><span class="p">){</span>
        <span class="c1">//如果人数不为空且和预定人数不符，则标红</span>
            <span class="nx">num</span> <span class="o">=</span> <span class="s1">&#39;&lt;b style=&quot;color:red&quot;&gt;&#39;</span><span class="o">+</span><span class="nx">json</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;&lt;/b&gt;&#39;</span><span class="o">+</span><span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="nx">i</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="c1">//否则正常输出</span>
            <span class="nx">num</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">content</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">j</span><span class="o">=</span><span class="nx">i</span><span class="p">,</span><span class="nx">pay</span><span class="p">;</span>
        <span class="c1">//输出为HTML表格</span>
        <span class="nx">content</span><span class="o">+=</span><span class="s1">&#39;&lt;div id=&quot;agreeI&quot;&gt;&lt;h5&gt;以下数据为读取报名表获得，内容和付费项仅供参考，可能有错误的项目已标红，若您确认报名表无错误，可继续上传&lt;/h5&gt;&lt;ul class=&quot;list-group&quot;&gt;&lt;li class=&quot;list-group-item&quot;&gt;学校：&#39;</span><span class="o">+</span><span class="nx">school</span><span class="o">+</span><span class="s1">&#39;&lt;/li&gt;&lt;li class=&quot;list-group-item&quot;&gt;领队：&#39;</span><span class="o">+</span><span class="nx">leader_name</span><span class="o">+</span><span class="s1">&#39;&lt;/li&gt;&lt;li class=&quot;list-group-item&quot;&gt;领队手机号：&#39;</span><span class="o">+</span><span class="nx">leader_phone</span><span class="o">+</span><span class="s1">&#39;&lt;/li&gt;&lt;li class=&quot;list-group-item&quot;&gt;代表人数(不含领队)：&#39;</span><span class="o">+</span><span class="nx">num</span><span class="o">+</span><span class="s1">&#39;&lt;/li&gt;&lt;/ul&gt;&lt;table class=&quot;table table-hover table-bordered&quot;&gt;&lt;thead&gt;&lt;tr&gt;&lt;th scope=&quot;col&quot;&gt;#&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;姓名&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;性别&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;会场&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;席位&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;双代&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;手机号&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;身份证&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;周五住宿&lt;/th&gt;&lt;th scope=&quot;col&quot;&gt;周六住宿&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&#39;</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;=</span><span class="nx">j</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
        <span class="c1">//遍历arr数据</span>
            <span class="nx">content</span><span class="o">+=</span><span class="s1">&#39;&lt;tr&gt;&lt;th scope=&quot;row&quot;&gt;&#39;</span><span class="o">+</span><span class="nx">i</span><span class="o">+</span><span class="s1">&#39;&lt;/th&gt;&lt;td&gt;&#39;</span><span class="o">+</span><span class="nx">Arr</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">name</span><span class="o">+</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">+</span><span class="nx">Arr</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">sex</span><span class="o">+</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">+</span><span class="nx">Arr</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">room</span><span class="o">+</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">+</span><span class="nx">Arr</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">seat</span><span class="o">+</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">+</span><span class="nx">Arr</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="kr">double</span><span class="o">+</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">+</span><span class="nx">Arr</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">phone</span><span class="o">+</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">+</span><span class="nx">Arr</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">identity</span><span class="o">+</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">+</span><span class="nx">Arr</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">fri</span><span class="o">+</span><span class="s1">&#39;&lt;/td&gt;&lt;td&gt;&#39;</span><span class="o">+</span><span class="nx">Arr</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">sat</span><span class="o">+</span><span class="s1">&#39;&lt;/td&gt;&#39;</span><span class="p">;</span>
            <span class="nx">Arr</span><span class="p">[</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">name</span><span class="o">==</span><span class="nx">leader_name</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">leader_pay</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">ld_pay</span><span class="o">=</span><span class="nx">leader_pay</span><span class="p">;</span>
        <span class="nx">pay</span> <span class="o">=</span> <span class="nx">json</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">9</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;是&quot;</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
        <span class="c1">//判断领队参会数据，为是则为0（不支付）</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">check</span><span class="p">.</span><span class="nx">empty</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">9</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">pay</span><span class="o">!==</span><span class="nx">leader_pay</span><span class="p">){</span>
        <span class="c1">//判断是否填入数据且不等于获取到的数据</span>
            <span class="nx">ld_pay</span> <span class="o">=</span> <span class="s1">&#39;&lt;b style=&quot;color:red&quot;&gt;&#39;</span><span class="o">+</span><span class="nx">pay</span><span class="o">+</span><span class="s1">&#39;&lt;/b&gt;&#39;</span><span class="o">+</span><span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="nx">leader_pay</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">retArr</span><span class="p">.</span><span class="nx">paytext</span><span class="o">=</span><span class="s1">&#39;&lt;h4&gt;应付会费（仅供参考）：&#39;</span><span class="o">+</span><span class="nx">num</span><span class="o">+</span><span class="s1">&#39;人 × ￥330 + &#39;</span><span class="o">+</span><span class="nx">ld_pay</span><span class="o">+</span><span class="s1">&#39;人 × ￥200 = ￥&#39;</span><span class="o">+</span><span class="p">(</span><span class="nx">j</span><span class="o">*</span><span class="mi">330</span><span class="o">+</span><span class="nx">leader_pay</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&lt;/h4&gt;&#39;</span><span class="p">;</span>
        <span class="c1">//实际参考计算按照读取到的数据计算</span>
        <span class="nx">content</span><span class="o">+=</span><span class="s1">&#39;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;&lt;/p&gt;&#39;</span><span class="o">+</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">paytext</span><span class="p">;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;StuList&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">content</span><span class="p">;</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#agreeI&#39;</span><span class="p">).</span><span class="nx">bootstrapMaterialDesign</span><span class="p">();</span>
        <span class="c1">//对刚加入的表格初始化materialDesign</span>
    <span class="p">},</span>
    <span class="nx">d</span><span class="o">:</span> <span class="p">()=&gt;{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">file</span><span class="o">==</span><span class="kc">null</span><span class="p">){</span>
        <span class="c1">//如果file不存在</span>
            <span class="nx">AlertM</span><span class="p">(</span><span class="s2">&quot;请选择或拖拽正式报名表文件&quot;</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">fileUp</span><span class="o">==</span><span class="kc">false</span><span class="p">){</span>
        <span class="c1">//如果file没有上传</span>
            <span class="nx">AlertM</span><span class="p">(</span><span class="s2">&quot;请单击 &lt;b&gt;确认上传&lt;/b&gt; 按钮上传或重新上传正式报名表&quot;</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="nx">load</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
            <span class="c1">//e卡片填入付款信息</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;reg-e-text&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">paytext</span><span class="p">;</span>
            <span class="nx">load</span><span class="p">.</span><span class="nx">up</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="s2">&quot;e&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">upD</span><span class="o">:</span> <span class="p">()=&gt;{</span>
    <span class="c1">//上传xlsx</span>
        <span class="nx">upload</span><span class="p">.</span><span class="nx">putObject</span><span class="p">(</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">file</span><span class="p">,</span><span class="s1">&#39;xlsx/&#39;</span><span class="o">+</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">school</span><span class="o">+</span><span class="s2">&quot;.xlsx&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="nx">AlertM</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;prog-text&quot;&gt;文件正在上传，请稍后&lt;br/&gt;请在弹出上传成功提示框后点击下一步&lt;br/&gt;若超过一分钟仍未上传成功，请单击确认上传重试&lt;br/&gt;&lt;/div&gt;&lt;div class=&quot;progress&quot; style=&quot;height: 20px;&quot;&gt;&lt;div class=&quot;progress-bar progress-bar-striped progress-bar-animated bg-info&quot; role=&quot;progressbar&quot; id=&quot;prog&quot; style=&quot;width: 20%&quot; aria-valuenow=&quot;50&quot; aria-valuemin=&quot;0&quot; aria-valuemax=&quot;100&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
        <span class="c1">//弹出模态框</span>
    <span class="p">},</span>
    <span class="nx">e</span><span class="o">:</span><span class="p">()=&gt;{</span>
        <span class="nx">load</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
        <span class="nx">load</span><span class="p">.</span><span class="nx">up</span><span class="p">(</span><span class="s2">&quot;e&quot;</span><span class="p">,</span><span class="s2">&quot;f&quot;</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">f</span><span class="o">:</span><span class="p">()=&gt;{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">pic</span><span class="o">==</span><span class="kc">null</span><span class="p">){</span>
        <span class="c1">//图片不存在</span>
            <span class="nx">AlertM</span><span class="p">(</span><span class="s2">&quot;请选择或拖拽支付截图&quot;</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">picUp</span><span class="o">==</span><span class="kc">false</span><span class="p">){</span>
        <span class="c1">//图片未上传</span>
            <span class="nx">AlertM</span><span class="p">(</span><span class="s2">&quot;请单击 &lt;b&gt;确认上传&lt;/b&gt; 按钮上传或重新上传支付截图&quot;</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="nx">AlertM</span><span class="p">(</span><span class="s2">&quot;正在提交数据，若超过一分钟未跳转至成功界面，请再次尝试提交数据&quot;</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">back</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;reg-f-back&quot;</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/get/reg&#39;</span><span class="p">,{</span><span class="s1">&#39;school&#39;</span><span class="o">:</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">school</span><span class="p">,</span><span class="s1">&#39;back&#39;</span><span class="o">:</span><span class="nx">back</span><span class="p">},</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">){</span>
            <span class="c1">//提交数据（学校名称和备注）</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">status</span><span class="o">!=</span><span class="mi">500</span><span class="p">){</span>
                <span class="c1">//500成功</span>
                    <span class="nx">AlertM</span><span class="p">(</span><span class="s2">&quot;错误：&quot;</span><span class="o">+</span><span class="nx">result</span><span class="p">.</span><span class="nx">status</span><span class="o">+</span><span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="o">+</span><span class="nx">result</span><span class="p">.</span><span class="nx">ret</span><span class="p">);</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="c1">//g卡片填入学校名称</span>
                    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;reg-g-name&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">result</span><span class="p">.</span><span class="nx">ret</span><span class="p">.</span><span class="nx">school</span><span class="p">;</span>
                    <span class="nx">load</span><span class="p">.</span><span class="nx">up</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">,</span><span class="s2">&quot;g&quot;</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">upF</span><span class="o">:</span> <span class="p">()=&gt;{</span>
    <span class="c1">//上传图片，注意：此处文件名为：学校-原图片名称-原后缀，这样是为了简便保留原后缀；v4版本设置的是学校名称+png固定后缀，由于图片文件头自带文件类型，所以png问题也不大</span>
        <span class="nx">upload</span><span class="p">.</span><span class="nx">putObject</span><span class="p">(</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">pic</span><span class="p">,</span><span class="s1">&#39;alipay/&#39;</span><span class="o">+</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">school</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="nx">retArr</span><span class="p">.</span><span class="nx">pic</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
        <span class="nx">AlertM</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;prog-text&quot;&gt;文件正在上传，请稍后&lt;br/&gt;请在弹出上传成功提示框后点击下一步&lt;br/&gt;若超过一分钟仍未上传成功，请单击确认上传重试&lt;br/&gt;&lt;/div&gt;&lt;div class=&quot;progress&quot; style=&quot;height: 20px;&quot;&gt;&lt;div class=&quot;progress-bar progress-bar-striped progress-bar-animated bg-info&quot; role=&quot;progressbar&quot; id=&quot;prog&quot; style=&quot;width: 20%&quot; aria-valuenow=&quot;50&quot; aria-valuemin=&quot;0&quot; aria-valuemax=&quot;100&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">};</span>
<span class="kd">var</span> <span class="nx">retArr</span> <span class="o">=</span> <span class="p">{</span>
<span class="c1">//回传数组</span>
    <span class="nx">school</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
    <span class="nx">file</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
    <span class="nx">fileUp</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span>
    <span class="nx">pic</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
    <span class="nx">picUp</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span>
    <span class="nx">back</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span>
    <span class="nx">paytext</span><span class="o">:</span><span class="kc">null</span>
<span class="p">};</span>
<span class="c1">// upl</span>
</pre></div>

<h3 id="jscos">JS（COS腾讯云）</h3>
<div class="codehilite"><pre><span></span><span class="c1">// upload</span>
<span class="kd">var</span> <span class="nx">cos</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">COS</span><span class="p">({</span>
    <span class="nx">getAuthorization</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">options</span><span class="p">,</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//COS获取鉴权凭证</span>
        <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;./upload/sts.php&#39;</span><span class="p">;</span>
        <span class="c1">//这个php文件要存在，下面写php内容</span>
        <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
        <span class="c1">//xhr获取凭证</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">responseText</span><span class="o">==</span><span class="s2">&quot;null&quot;</span><span class="p">){</span>
            <span class="c1">//由于服务器原因会获取失败</span>
                <span class="nx">AlertM</span><span class="p">(</span><span class="s2">&quot;获取数据错误，请重新上传&quot;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="c1">//回调函数来源腾讯云SDK源码</span>
            <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
            <span class="nx">callback</span><span class="p">({</span>
                <span class="nx">TmpSecretId</span><span class="o">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">credentials</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">credentials</span><span class="p">.</span><span class="nx">tmpSecretId</span><span class="p">,</span>
                <span class="nx">TmpSecretKey</span><span class="o">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">credentials</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">credentials</span><span class="p">.</span><span class="nx">tmpSecretKey</span><span class="p">,</span>
                <span class="nx">XCosSecurityToken</span><span class="o">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">credentials</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">credentials</span><span class="p">.</span><span class="nx">sessionToken</span><span class="p">,</span>
                <span class="nx">ExpiredTime</span><span class="o">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">expiredTime</span>
            <span class="p">});</span>
        <span class="p">};</span>
        <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="kd">var</span> <span class="nx">upload</span><span class="o">=</span><span class="p">{</span>
<span class="c1">//上传函数</span>
    <span class="nx">Bucket</span><span class="o">:</span><span class="s1">&#39;2019test-1251935573&#39;</span><span class="p">,</span>
    <span class="c1">//存储桶，和鉴权凭证一起改</span>
    <span class="nx">Region</span><span class="o">:</span><span class="s1">&#39;ap-chengdu&#39;</span><span class="p">,</span>
    <span class="c1">//存储桶地区</span>
    <span class="nx">putObject</span><span class="o">:</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="nx">file</span><span class="p">,</span><span class="nx">fileType</span><span class="p">)=&gt;{</span>
    <span class="c1">//简单文件上传，官方文档：【https://cloud.tencent.com/document/product/436/35649】【https://cloud.tencent.com/document/product/436/7749】</span>
        <span class="nx">cos</span><span class="p">.</span><span class="nx">putObject</span><span class="p">({</span>
            <span class="nx">Bucket</span><span class="o">:</span> <span class="nx">upload</span><span class="p">.</span><span class="nx">Bucket</span><span class="p">,</span>
            <span class="nx">Region</span><span class="o">:</span> <span class="nx">upload</span><span class="p">.</span><span class="nx">Region</span><span class="p">,</span>
            <span class="nx">Key</span><span class="o">:</span> <span class="nx">file</span><span class="p">,</span>
            <span class="nx">Body</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
            <span class="nx">onProgress</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">progressData</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">//进度函数</span>
                <span class="kd">var</span> <span class="nx">prog</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;prog&quot;</span><span class="p">);</span>
                <span class="c1">//获取进度条元素</span>
                <span class="nx">prog</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="o">=</span><span class="nx">progressData</span><span class="p">.</span><span class="nx">percent</span><span class="o">*</span><span class="mi">100</span><span class="o">+</span><span class="s2">&quot;%&quot;</span><span class="p">;</span>
                <span class="nx">prog</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">progressData</span><span class="p">.</span><span class="nx">loaded</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="nx">progressData</span><span class="p">.</span><span class="nx">total</span><span class="o">+</span><span class="s2">&quot;&amp;emsp;&amp;emsp;&quot;</span><span class="o">+</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">progressData</span><span class="p">.</span><span class="nx">speed</span><span class="o">/</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="o">+</span><span class="s2">&quot;KB/s&quot;</span><span class="p">;</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">progressData</span><span class="p">));</span>
            <span class="p">},</span>
        <span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="c1">//1s后显示上传成功</span>
                <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;prog-text&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&quot;上传成功！&quot;</span><span class="p">;</span>
                <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#AlertModal&quot;</span><span class="p">).</span><span class="nx">modal</span><span class="p">(</span><span class="s2">&quot;show&quot;</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">fileType</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                    <span class="nx">retArr</span><span class="p">.</span><span class="nx">fileUp</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="nx">retArr</span><span class="p">.</span><span class="nx">picUp</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">},</span><span class="mi">1000</span><span class="p">);</span>

        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="x">//由于鉴权凭证计算是腾讯云官方sdk，所以就示例参数部分，后面不改</span>
<span class="cp">&lt;?php</span>
<span class="c1">// 临时密钥计算样例</span>
<span class="c1">// 配置参数</span>
<span class="nv">$config</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;Url&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;https://sts.api.qcloud.com/v2/index.php&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Domain&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;sts.api.qcloud.com&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Proxy&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SecretId&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;AKIDl****3byAF9weCZllgNy&#39;</span><span class="p">,</span> <span class="c1">// 固定密钥</span>
    <span class="c1">//腾讯云SecretKey</span>
    <span class="s1">&#39;SecretKey&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;kLTV****GcptlBRVN3Yr&#39;</span><span class="p">,</span> <span class="c1">// 固定密钥</span>
    <span class="c1">//腾讯云SecretID</span>
    <span class="s1">&#39;Bucket&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2019test-1251935573&#39;</span><span class="p">,</span>
    <span class="c1">//存储桶</span>
    <span class="s1">&#39;Region&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ap-chengdu&#39;</span><span class="p">,</span>
    <span class="c1">//存储桶地区</span>
    <span class="s1">&#39;AllowPrefix&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="c1">// 必填，这里改成允许的路径前缀，这里可以根据自己网站的用户登录态判断允许上传的目录，例子：* 或者 a/* 或者 a.jpg</span>
<span class="p">);</span>
</pre></div>

<h3 id="cos">腾讯云COS的其他设置内容</h3>
<ul>
<li>存储桶-基本配置-跨域访问CORS设置</li>
<li>来源Origin：http://www.runmun.site</li>
<li>操作 Methods：上传：PUT；下载：GET</li>
<li>Allow-Headers：*</li>
<li>存储桶设置：上传的桶需要设置私有读写，下载桶需要设置公有读私有写</li>
</ul>
<h3 id="html">HTML框架</h3>
<div class="codehilite"><pre><span></span><span class="p">&lt;</span><span class="nt">body</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;margin:0;padding:0&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;position:absolute;z-index:-999;width:100%;height:100%;&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;bg&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    //背景（为读取窗口大小设置的元素）
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;m-card-lightblue&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;load_btn&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;position: fixed;width: 100%;height: 100%;z-index: 999;padding: 0;margin: 0;top: 0;background: rgba(255,255,255,.8);&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;m-spinner-blue center-force&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    //加载圈
    <span class="c">&lt;!----&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;modal fade&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;AlertModal&quot;</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">&quot;-1&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;dialog&quot;</span> <span class="na">aria-labelledby</span><span class="o">=</span><span class="s">&quot;AlertModal&quot;</span> <span class="na">aria-hidden</span><span class="o">=</span><span class="s">&quot;true&quot;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;modal-dialog&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;document&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;modal-content&quot;</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;modal-header&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h5</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;modal-title&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;AlertModal-title&quot;</span><span class="p">&gt;</span>提示<span class="p">&lt;/</span><span class="nt">h5</span><span class="p">&gt;</span>
          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;modal-body&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;AlertModal-text&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
          //提示信息框
          <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;modal-footer&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-info&quot;</span> <span class="na">data-dismiss</span><span class="o">=</span><span class="s">&quot;modal&quot;</span><span class="p">&gt;</span>确认<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    //提示模态框
    <span class="c">&lt;!----&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-a&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container material-container&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width:70%;margin:auto;position:absolute;left:0;top:0;right:0;display:table;&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;display:table-cell;vertical-align: middle;padding: 30px;&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>润梦 RUNMUN 2019 中学生模拟联合国大会<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>正式报名<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">/&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>须知确认（1/7）<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;alert alert-info&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;alert&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;alert-heading&quot;</span><span class="p">&gt;</span>在正式报名前你需要知晓《报名须知》<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
                //须知，注意不要出现最终解释权等内容
                <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>阅读并同意本《报名须知》（以下简称《须知》），方可报名润梦2019模拟联合国大会<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>在本次报名开放前填写的《预报名表》和《会场意向表》生效，本表开放后（截至2019/10/1 18:00）数据不再进行同步（特殊情况除外）<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>填写本表即代表正式报名润梦2019模拟联合国大会，请认真填写本表<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>本表截止报名后，不会重新开放，请各位代表注意在本表截止日期前完成填写（特殊情况除外）<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>在最后 <span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>确认报名页面<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span> 单击 <span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>确认报名按钮<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span> 后，会显示报名成功，再此之前仍然可以对先前的报名数据进行修改<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>一旦报名及付费成功，为保护代表个人信息，该学校将被锁定，不再开放修改（特殊情况除外）<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>请使用较高版本和兼容性较好的浏览器（如Google Chrome等）进行报名，不支持IE浏览器（360等浏览器请使用极速模式）<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>请使用宽度大于720px的浏览器进行报名，推荐使用电脑端浏览器进行报名<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>使用不合适的浏览器打开本页面可能造成的后果可能有<span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
                      <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>页面显示不全<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                      <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>报名信息提交失败<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                      <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>无法输入信息<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                      <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>支付失败<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                      <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>无法上传支付截图<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                      <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>等<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>本表内付款仅限 <span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>代表<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span> 的 <span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>会费<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span> ，观察员的会费及所有住宿费用不在此项，请勿同时付款<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;color:red&quot;</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>正式报名成功后不接受任何形式的退款要求，付款前请务必确认好各项信息的准确有效<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>请各位代表付款后妥善保留好支付截图作为支付凭证<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>请在填表前确认可支付款项充足，请勿分为多次进行付费，付费后请截图并在本表内上传方为有效支付，如有特殊情况，请联系秘书长<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>润梦2019模拟联合国大会《住宿信息表格》未被包含在本表内，需要填写该表的领队请至官网首页下载该表<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>由于本《须知》中所提到的条目落空，而造成的报名失败或填写错误等问题，润梦2019组委会不对此负责<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>如有特殊情况请与秘书长协商和沟通<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                  <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>本《须知》可能进行更新或修改，组委会不会对此进行通知<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">/&gt;</span>
            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;m-input-checkbox-lightblue&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-a-check&quot;</span>  <span class="na">data-label</span><span class="o">=</span><span class="s">&quot;我已阅读并同意以上须知&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info float-left btn-lg&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-a-dl&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;downloadXlsx()&quot;</span><span class="p">&gt;</span>下载报名表单<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info float-right btn-lg&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-a-next&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;regAct.a()&quot;</span><span class="p">&gt;</span>下一步<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>

        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="c">&lt;!----&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-b&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container material-container&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width:450px;margin:auto;position:absolute;left:0;top:0;right:0;display:none;opacity: 0;&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;display:table-cell;vertical-align: middle;padding: 30px;&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>润梦 RUNMUN 2019 中学生模拟联合国大会<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>正式报名<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>学校选择（2/7）<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">form</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group bmd-form-group&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;SchoolName&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;bmd-label-floating&quot;</span><span class="p">&gt;</span>输入您的学校名称进行筛选<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;SchoolName&quot;</span> <span class="na">oninput</span><span class="o">=</span><span class="s">&quot;regAct.searchSchool()&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">h6</span><span class="p">&gt;</span>请在以下列表进行选择<span class="p">&lt;/</span><span class="nt">h6</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;SchoolList&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info float-left btn-lg&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-b-next&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;load.back(&#39;b&#39;,&#39;a&#39;);&quot;</span><span class="p">&gt;</span>上一步<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info float-right btn-lg&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-b-next&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;regAct.b();&quot;</span><span class="p">&gt;</span>下一步<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="c">&lt;!----&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-c&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container material-container&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width:600px;margin:auto;position:absolute;left:0;top:0;right:0;display:none;opacity: 0;&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;display:table-cell;vertical-align: middle;padding: 30px;&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>润梦 RUNMUN 2019 中学生模拟联合国大会<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>正式报名<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>填写正式报名表（3/7）<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>
            //提示信息
                <span class="p">&lt;</span><span class="nt">h5</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align:left&quot;</span><span class="p">&gt;</span>尊敬的 <span class="p">&lt;</span><span class="nt">b</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;c-SchoolName&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">b</span><span class="p">&gt;</span> 代表，您好！<span class="p">&lt;</span><span class="nt">br</span><span class="p">/&gt;</span><span class="ni">&amp;emsp;&amp;emsp;</span>请填写您在第一步下载的正式报名表，若您没有下载，可点击下方 <span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>下载报名表<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span> 按钮进行下载。<span class="p">&lt;</span><span class="nt">br</span><span class="p">/&gt;</span><span class="ni">&amp;emsp;&amp;emsp;</span>请确认您的<span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>学校名称<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span>和<span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>席位数据<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span>正常，如有错误，请单击 <span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>上一步<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span> 重新选择或联系秘书长。<span class="p">&lt;</span><span class="nt">br</span><span class="p">/&gt;</span><span class="ni">&amp;emsp;&amp;emsp;</span>注：<span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>请勿修改<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span>非报名数据内容和工作表名称，否则可能造成无法预料的错误。<span class="p">&lt;</span><span class="nt">br</span><span class="p">/&gt;&lt;</span><span class="nt">br</span><span class="p">/&gt;</span>报名数据或提示信息：<span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;c-SchoolInfo&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">/&gt;&lt;</span><span class="nt">br</span><span class="p">/&gt;</span>填写完毕后请点击 <span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>下一步<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span> 上传报名表<span class="p">&lt;/</span><span class="nt">h5</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;float-left&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info btn-lg&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-c-next&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;load.back(&#39;c&#39;,&#39;b&#39;);&quot;</span><span class="p">&gt;</span>上一步<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info btn-lg&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-a-dl&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;downloadXlsx()&quot;</span><span class="p">&gt;</span>下载报名表单<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info float-right btn-lg&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-c-next&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;regAct.c();&quot;</span><span class="p">&gt;</span>下一步<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="c">&lt;!----&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-d&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container material-container&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width:70%;min-width:720px;margin:auto;position:absolute;left:0;top:0;right:0;display:none;opacity: 0;&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;display:table-cell;vertical-align: middle;padding: 30px;&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>润梦 RUNMUN 2019 中学生模拟联合国大会<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>正式报名<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>上传正式报名表（4/7）<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;StuList&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align: center;&quot;</span><span class="p">&gt;</span>
            //上传xlsx
                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;drop&quot;</span><span class="p">&gt;</span>拖拽填写完毕的正式报名表文件至此或在下方选择文件上传<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;file&quot;</span> <span class="na">accept</span><span class="o">=</span><span class="s">&quot;.xlsx&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;选择正式报名表&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;xlsx_file&quot;</span><span class="p">&gt;&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info btn-sm&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;regAct.upD();&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;up-xlsx&quot;</span><span class="p">&gt;</span>确认上传<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">h5</span><span class="p">&gt;</span>注：在单击确认上传前，您可以随时拖拽或选择新文件覆盖原先选择的文件。在最后一步确认报名前，您可以随时回退到当前步骤重新上传文件覆盖原先上传的文件。<span class="p">&lt;/</span><span class="nt">h5</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info float-left btn-lg&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-d-next&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;load.back(&#39;d&#39;,&#39;c&#39;);&quot;</span><span class="p">&gt;</span>上一步<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;float-right&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info btn-lg&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-e-next&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;regAct.d();&quot;</span><span class="p">&gt;</span>下一步<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="c">&lt;!----&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-e&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container material-container&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width:70%;margin:auto;position:absolute;left:0;top:0;right:0;display:none;opacity: 0;&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;display:table-cell;vertical-align: middle;padding: 30px;&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>润梦 RUNMUN 2019 中学生模拟联合国大会<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>正式报名<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>付款（5/7）<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;agree&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align:center&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://runmun-1251935573.cos.ap-chengdu.myqcloud.com/rreg/alipay.jpg&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width: 250px;&quot;</span><span class="p">&gt;</span>
                    //支付宝收款码，可以尝试用商家收款码，zfb送提现到银行卡额度
                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align:center&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>支付宝<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>扫描二维码付款后截图<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-e-text&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span>支付备注：学校名称—领队姓名—代表人数(领队不参会则不计)<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span>截图请包含：金额、订单号<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info float-left btn-lg&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-e-next&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;load.back(&#39;e&#39;,&#39;d&#39;);&quot;</span><span class="p">&gt;</span>上一步<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info btn-lg float-right&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-e-next&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;regAct.e();&quot;</span><span class="p">&gt;</span>下一步<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="c">&lt;!----&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-f&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container material-container&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width:700px;margin:auto;position:absolute;left:0;top:0;right:0;display:none;opacity: 0;&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;display:table-cell;vertical-align: middle;padding: 30px;&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>润梦 RUNMUN 2019 中学生模拟联合国大会<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>正式报名<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>上传付款截图（6/7）<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;pay&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align:center&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://t.alipayobjects.com/images/T1HHFgXXVeXXXXXXXX.png&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width: 250px;&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;pay-img&quot;</span><span class="p">&gt;</span>
                    //这里src随便找了张zfb的图，注意pay-img留着即可，src可以改，此处显示的是选择的截图
                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align:center&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;drop-pic&quot;</span><span class="p">&gt;</span>拖拽支付截图文件至此或在下方选择文件上传(多张图片请压缩为一个压缩包进行上传)<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;file&quot;</span> <span class="na">accept</span><span class="o">=</span><span class="s">&quot;image/*&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;选择支付截图&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;pic_file&quot;</span><span class="p">&gt;&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info btn-sm&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;regAct.upF();&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;up-xlsx&quot;</span><span class="p">&gt;</span>确认上传<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">h5</span><span class="p">&gt;</span>注：在单击确认上传前，您可以随时拖拽或选择新文件覆盖原先选择的文件。在最后一步确认报名前，您可以随时回退到当前步骤重新上传文件覆盖原先上传的文件。<span class="p">&lt;/</span><span class="nt">h5</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h5</span><span class="p">&gt;</span>备注项（选填）<span class="p">&lt;/</span><span class="nt">h5</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">textarea</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-f-back&quot;</span> <span class="na">rows</span><span class="o">=</span><span class="s">&quot;3&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">textarea</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info float-left btn-lg&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-f-next&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;load.back(&#39;f&#39;,&#39;e&#39;);&quot;</span><span class="p">&gt;</span>上一步<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info btn-lg float-right&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-f-next&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;regAct.f();&quot;</span><span class="p">&gt;</span>提交数据<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="c">&lt;!----&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-g&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container material-container&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width:70%;margin:auto;position:absolute;left:0;top:0;right:0;display:none;opacity: 0;&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;card&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;display:table-cell;vertical-align: middle;padding: 30px;&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>润梦 RUNMUN 2019 中学生模拟联合国大会<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>正式报名<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;c-align-center&quot;</span><span class="p">&gt;</span>报名成功（7/7）<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;thanks&quot;</span><span class="p">&gt;</span>尊敬的 <span class="p">&lt;</span><span class="nt">b</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-g-name&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">b</span><span class="p">&gt;</span> 代表，您已成功报名润梦 RUNMUN 2019模拟联合国大会！<span class="p">&lt;</span><span class="nt">br</span><span class="p">/&gt;</span><span class="ni">&amp;emsp;&amp;emsp;</span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span>感谢您对润梦的支持和信任！润梦，梦在润园，润园润梦，顺颂曼福。<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-raised btn-info btn-lg float-right&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;reg-g-next&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;parent.location.href=&#39;/?spm=rreg&#39;;&quot;</span><span class="p">&gt;</span>返回首页<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="c">&lt;!----&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</pre></div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../runmun/" title="润梦专题" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                润梦专题
              </span>
            </div>
          </a>
        
        
          <a href="../elseprog/" title="其他库" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                其他库
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b41f3d20.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../assets/javascripts/lunr/lunr.jp.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../assets/toomuch.js"></script>
      
        <script src="../../search/main.js"></script>
      
    
    
      
    
  </body>
</html>